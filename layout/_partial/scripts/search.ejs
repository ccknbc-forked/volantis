<script>
  <% if(theme.search.service === 'baidu') { %>
    var BAIDU_API_ID = "<%- theme.search.baidu.apiId %>";
  <%} else if(theme.search.service === 'algolia') { %>
    var ALGOLIA_API_KEY = "<%- theme.search.algolia.apiKey %>";
    var ALGOLIA_APP_ID = "<%- theme.search.algolia.applicationID %>";
    var ALGOLIA_INDEX_NAME = "<%- theme.search.algolia.indexName %>";
  <%} else if(theme.search.service === 'azure') { %>
    var AZURE_QUERY_KEY = "<%- theme.search.azure.queryKey %>";
    var AZURE_INDEX_NAME = "<%- theme.search.azure.indexName %>";
    var AZURE_SERVICE_NAME = "<%- theme.search.azure.serviceName %>";
  <%} else if(theme.search.service === 'google') { %>
    var GOOGLE_CUSTOM_SEARCH_API_KEY = "<%- theme.search.google.apiKey %>";
    var GOOGLE_CUSTOM_SEARCH_ENGINE_ID = "<%- theme.search.google.engineId %>";
  <%}%>
  var SEARCH_SERVICE = "<%- theme.search.service %>" || "hexo";
  var ROOT = "<%- config.root %>" || "/";
  if (!ROOT.endsWith('/')) ROOT += '/';

  $('.input.u-search-input').one('focus',function(){
    var HEAD = document.getElementsByTagName('head')[0] || document.documentElement;
    var src = '<%- theme.search.js %>';
    var script = document.createElement('script');
    script.setAttribute('type','text/javascript');
    script.onload = function() {
      setSearchService();
    }
    script.setAttribute('src', src);
    HEAD.appendChild(script);
  })

  // 设置搜索服务
	function setSearchService() {
		var SearchServiceimagePath="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@master/img/"
		if (SEARCH_SERVICE === 'google') {
			customSearch = new GoogleCustomSearch({
				apiKey: GOOGLE_CUSTOM_SEARCH_API_KEY,
				engineId: GOOGLE_CUSTOM_SEARCH_ENGINE_ID,
				imagePath: SearchServiceimagePath
			});
		} else if (SEARCH_SERVICE === 'algolia') {
			customSearch = new AlgoliaSearch({
				apiKey: ALGOLIA_API_KEY,
				appId: ALGOLIA_APP_ID,
				indexName: ALGOLIA_INDEX_NAME,
				imagePath: SearchServiceimagePath
			});
		} else if (SEARCH_SERVICE === 'hexo') {
			customSearch = new HexoSearch({
				imagePath: SearchServiceimagePath
			});
		} else if (SEARCH_SERVICE === 'azure') {
			customSearch = new AzureSearch({
				serviceName: AZURE_SERVICE_NAME,
				indexName: AZURE_INDEX_NAME,
				queryKey: AZURE_QUERY_KEY,
				imagePath: SearchServiceimagePath
			});
		} else if (SEARCH_SERVICE === 'baidu') {
			customSearch = new BaiduSearch({
				apiId: BAIDU_API_ID,
				imagePath: SearchServiceimagePath
			});
		}
	}
</script>
